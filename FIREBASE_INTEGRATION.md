# Firebase Database Integration

## üìã –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å Firebase Firestore Database –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ –∫—ç–º–ø–æ–≤. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö.

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Firebase Configuration
- **–§–∞–π–ª**: `src/lib/firebase.ts`
- **–°–µ—Ä–≤–∏—Å—ã**: Authentication + Firestore Database
- **–ö–æ–ª–ª–µ–∫—Ü–∏—è**: `camps` (—Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∫—ç–º–ø–æ–≤)

### –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
- **–§–∞–π–ª**: `src/lib/camps.ts`
- **–§—É–Ω–∫—Ü–∏–∏**: CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –ø–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Date ‚Üî Timestamp, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### React Hook
- **–§–∞–π–ª**: `src/hooks/useCamps.ts`
- **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, fallback –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

## üöÄ –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```typescript
// –ï—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
if (campsData.length === 0) {
  await seedCamps(sampleCamps);
}
```

### 2. Resilient –∑–∞–≥—Ä—É–∑–∫–∞
```typescript
// –ü—Ä–∏ –æ—à–∏–±–∫–µ Firebase - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
catch (err) {
  setCamps(sampleCamps); // Fallback
}
```

### 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```typescript
// –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
const campsQuery = query(
  campsCollection, 
  orderBy('createdAt', 'desc')
);
```

## üéØ Firebase Database Schema

### –ö–æ–ª–ª–µ–∫—Ü–∏—è: `camps`
```typescript
{
  id: string,                    // Auto-generated Firebase ID
  title: string,                 // –ù–∞–∑–≤–∞–Ω–∏–µ –∫—ç–º–ø–∞
  description: string,           // –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  startDate: Timestamp,          // –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
  endDate: Timestamp,            // –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
  location: string,              // –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è
  type: CampType,               // –¢–∏–ø –∫—ç–º–ø–∞
  price: number,                // –°—Ç–æ–∏–º–æ—Å—Ç—å
  capacity: number,             // –ú–∞–∫—Å–∏–º—É–º –º–µ—Å—Ç
  registered: number,           // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö
  organizer: string,            // –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä
  image: string,                // URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  features: string[],           // –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
  difficulty: CampDifficulty,   // –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
  ageGroup: string,             // –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞
  included: string[],           // –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ
  createdAt: Timestamp,         // –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
  updatedAt: Timestamp          // –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
}
```

## üõ†Ô∏è Admin Panel Features

### –î–æ—Å—Ç—É–ø
- **URL**: `/admin`
- **–ü—Ä–∞–≤–∞**: –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å `@campanion.ru`
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –¢—Ä–µ–±—É–µ—Ç—Å—è Firebase Auth

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫—ç–º–ø–æ–≤ –∏–∑ Firebase
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫—ç–º–ø–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```typescript
const isAdmin = user?.email?.endsWith('@campanion.ru');
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è
- üü¢ **–ü–æ–¥–∫–ª—é—á–µ–Ω–æ**: –£—Å–ø–µ—à–Ω–∞—è —Å–≤—è–∑—å —Å Firebase
- üîÑ **–ó–∞–≥—Ä—É–∑–∫–∞**: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå **–û—à–∏–±–∫–∞**: Fallback –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

### –ú–µ—Ç—Ä–∏–∫–∏
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—ç–º–ø–æ–≤ –≤ –±–∞–∑–µ
- –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üîÑ Data Flow

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç /camps
2. useCamps() –≤—ã–∑—ã–≤–∞–µ—Ç getAllCamps()
3. Firebase Firestore –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
4. –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ React state
5. UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
```

### Fallback Strategy
```
Firebase Error ‚Üí Static Data ‚Üí User Notification
```

## üìà Performance Optimizations

### 1. –ú–µ–º–æ–∏–∑–∞—Ü–∏—è
```typescript
const filteredCamps = useMemo(() => {
  return camps.filter(/* filters */);
}, [camps, searchTerm, selectedType]);
```

### 2. Lazy Loading
- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### 3. Error Boundaries
- Graceful fallback –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏—Ç –∫–æ–Ω—Ç–µ–Ω—Ç

## üîß –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Firebase
```bash
# –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: /admin -> "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
# –ò–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ:
await seedCamps(sampleCamps);
```

### –û—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: /admin -> "–û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É"
# –ò–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ —á–µ—Ä–µ–∑ Firebase Console
```

## üåü –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚ö° –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- üîÑ –í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- üõ°Ô∏è –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- üìä –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- üîß –ü—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∫—ç–º–ø–æ–≤
- üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- üöÄ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Firebase
- üì± Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üìã –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- ‚úÖ Firebase Auth –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ Firestore Database –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫—ç–º–ø–æ–≤
- ‚úÖ React Hooks –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- ‚úÖ Admin Panel –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ Fallback –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ loading states
- ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è TypeScript
- ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- ‚úÖ Responsive UI –¥–ª—è –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ Security Rules –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

## üîí Security Rules

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
Firebase Security Rules –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // –ö—ç–º–ø—ã –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —á—Ç–µ–Ω–∏—è –≤—Å–µ–º, –∑–∞–ø–∏—Å—å —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º
    match /camps/{campId} {
      allow read: if true;                    // –ü—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ
      allow write: if request.auth != null;   // –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å
    }
    
    // –°–æ–±—ã—Ç–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    match /events/{eventId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && 
                      request.auth.uid == resource.data.userId;
    }
  }
}
```

### –ü–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–ö–æ–ª–ª–µ–∫—Ü–∏—è `camps`**: –ü—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ, –∑–∞—â–∏—â–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å
- **–ö–æ–ª–ª–µ–∫—Ü–∏—è `events`**: –ü–æ–ª–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω—ã email –¥–æ–º–µ–Ω—É `@campanion.ru`

**üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –°–º. `FIRESTORE_SECURITY_RULES.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Firebase –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö —Å –Ω–∞–¥–µ–∂–Ω—ã–º fallback –º–µ—Ö–∞–Ω–∏–∑–º–æ–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–µ—Å–ø–µ—Ä–µ–±–æ–π–Ω—É—é —Ä–∞–±–æ—Ç—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤. 